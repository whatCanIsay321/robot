import asyncio
from typing import List, Dict, Any, Optional, Union
from pymilvus import AsyncMilvusClient


class MilvusHybridRetriever:
    """
    ðŸ” Milvus æ··åˆæ£€ç´¢å™¨ (Dense + BM25)
    æ”¯æŒå¼‚æ­¥ + æ‰¹é‡è¾“å…¥ + åŒå—åˆå¹¶ + åŽ»é‡ã€‚
    """

    def __init__(
        self,
        uri: str,
        token: str,
        default_top_k: int = 10,
    ):
        self.async_client = AsyncMilvusClient(uri=uri, token=token)
        self.default_top_k = default_top_k

    # ===========================================================
    # ðŸ”¹ BM25 Search
    # ===========================================================
    async def bm25_search(
        self,
        collection_name: str,
        queries: Union[str, List[str]],
        top_k: Optional[int] = None,
        output_fields: Optional[List[str]] = None,
    ) -> List[Dict[str, Any]]:
        top_k = top_k or self.default_top_k
        output_fields = output_fields or ["text"]
        if isinstance(queries, str):
            queries = [queries]

        try:
            res = await self.async_client.search(
                collection_name=collection_name,
                data=queries,
                anns_field="bm25",
                limit=top_k,
                output_fields=output_fields,
            )
            return self._merge_same_chunk(res, source="bm25")
        except Exception as e:
            print(f"âŒ BM25 æœç´¢å¤±è´¥: {e}")
            return []

    # ===========================================================
    # ðŸ”¹ Dense Search
    # ===========================================================
    async def dense_search(
        self,
        collection_name: str,
        query_vectors: Union[List[float], List[List[float]]],
        top_k: Optional[int] = None,
        output_fields: Optional[List[str]] = None,
    ) -> List[Dict[str, Any]]:
        top_k = top_k or self.default_top_k
        output_fields = output_fields or ["text"]

        if isinstance(query_vectors[0], (int, float)):
            query_vectors = [query_vectors]

        try:
            res = await self.async_client.search(
                collection_name=collection_name,
                data=query_vectors,
                anns_field="embedding",
                limit=top_k,
                output_fields=output_fields,
            )
            return self._merge_same_chunk(res, source="dense")
        except Exception as e:
            print(f"âŒ Dense æœç´¢å¤±è´¥: {e}")
            return []

    # ===========================================================
    # ðŸ”¹ Hybrid Search (BM25 + Dense, åŽ»é‡)
    # ===========================================================
    async def hybrid_search(
        self,
        collection_name: str,
        query_texts: Union[str, List[str]],
        query_vectors: Union[List[float], List[List[float]]],
        top_k: Optional[int] = None,
        output_fields: Optional[List[str]] = None,
    ) -> List[Dict[str, Any]]:
        """
        åŒæ—¶æ‰§è¡Œ BM25 ä¸Ž Dense æœç´¢ï¼Œä¸åŠ æƒï¼Œä»…åšç»“æžœåˆå¹¶åŽ»é‡ã€‚
        """
        bm25_task = asyncio.create_task(
            self.bm25_search(collection_name, query_texts, top_k, output_fields)
        )
        dense_task = asyncio.create_task(
            self.dense_search(collection_name, query_vectors, top_k, output_fields)
        )

        bm25_results, dense_results = await asyncio.gather(bm25_task, dense_task)

        # ðŸ”¹ åˆå¹¶åŽ»é‡ï¼ˆæ ¹æ® chunk idï¼‰
        combined: Dict[str, Dict[str, Any]] = {}
        for result_list in [bm25_results, dense_results]:
            for r in result_list:
                cid = r["id"]
                if cid not in combined:
                    combined[cid] = r
                else:
                    # è‹¥é‡å¤ï¼Œåªä¿ç•™æœ€é«˜åˆ†
                    if r["merged_score"] > combined[cid]["merged_score"]:
                        combined[cid] = r

        # ðŸ”¹ æŒ‰å¾—åˆ†é™åºæŽ’åˆ—
        final_results = sorted(combined.values(), key=lambda x: x["merged_score"], reverse=True)
        return final_results

    # ===========================================================
    # ðŸ”¹ åŒå—ç»“æžœåˆå¹¶
    # ===========================================================
    @staticmethod
    def _merge_same_chunk(res: Any, source: str) -> List[Dict[str, Any]]:
        if not res:
            return []

        chunk_scores: Dict[str, Dict[str, Any]] = {}

        for hits in res:
            for hit in hits:
                text = None
                if hasattr(hit, "entity") and hasattr(hit.entity, "get"):
                    text = hit.entity.get("text")
                elif isinstance(getattr(hit, "entity", None), dict):
                    text = hit.entity.get("text")
                chunk_id = getattr(hit, "id", text)
                score = getattr(hit, "score", 0.0)

                if chunk_id not in chunk_scores:
                    chunk_scores[chunk_id] = {
                        "id": chunk_id,
                        "text": text,
                        "merged_score": score,
                        "count": 1,
                        "source": source,
                    }
                else:
                    chunk_scores[chunk_id]["merged_score"] += score
                    chunk_scores[chunk_id]["count"] += 1

        merged_list = list(chunk_scores.values())
        merged_list.sort(key=lambda x: x["merged_score"], reverse=True)
        return merged_list

    async def close(self):
        await self.async_client.close()


# ===========================================================
# ðŸ”¹ Example Usage
# ===========================================================
async def main():
    retriever = MilvusHybridRetriever(
        uri="http://10.60.200.100:19530",
        token="root:Milvus",
        default_top_k=3,
    )

    query_texts = ["bright day grace speed horizon lazy dog"]
    query_vectors = [[0.03874610736966133,-0.9121343493461609,0.5225425362586975,0.9623935222625732,0.6157792210578918,-0.37025874853134155,-0.282817006111145,0.0955372229218483,-0.4844511151313782,0.284455806016922,0.6992628574371338,-0.9727903008460999,-0.9179213643074036,-0.6987277865409851,0.7395193576812744,-0.186482235789299,-0.24087195098400116,0.5164092779159546,-0.40663161873817444,-0.5320587754249573,-0.8997090458869934,-0.6388384103775024,0.07498452067375183,0.17015869915485382,0.41382893919944763,0.7282357811927795,-0.3553554117679596,0.7632336020469666,-0.7703791260719299,0.15738815069198608,0.03255336731672287,0.7672006487846375,-0.8356149792671204,-0.2900533080101013,-0.8894666433334351,-0.7935012578964233,-0.1498706191778183,-0.44778624176979065,-0.10471230000257492,0.5536566376686096,-0.5820791125297546,0.543157160282135,-0.5146729946136475,-0.5791265368461609,0.19421908259391785,0.6892592906951904,-0.5674815773963928,-0.3419741094112396,-0.7355947494506836,0.9030738472938538,-0.2965824007987976,0.3006228506565094,0.4129502773284912,0.8328791856765747,0.5708473324775696,0.09068146347999573,0.01641913503408432,-0.8122174143791199,0.5907905101776123,-0.7231813669204712,0.7226255536079407,-0.0854671522974968,-0.3975365459918976,-0.5090519189834595,0.1200774759054184,-0.5261823534965515,-0.5088270902633667,0.6817505955696106,-0.22305208444595337,0.12007895112037659,0.985024094581604,0.19642405211925507,0.00730633269995451,0.3680618405342102,0.44657883048057556,0.4712330996990204,0.667100191116333,0.23400020599365234,-0.9732003211975098,0.24516279995441437,0.8705410361289978,0.387147456407547,0.20108386874198914,0.03626948967576027,0.3172067403793335,-0.9305471181869507,-0.808805525302887,0.19962137937545776,0.47009122371673584,-0.7896767854690552,-0.3951181173324585,0.9689458608627319,-0.5067249536514282,0.7977299094200134,0.6709264516830444,0.575233519077301,0.2129320204257965,0.3699380159378052,0.8034173250198364,-0.8094589114189148,-0.7556023001670837,-0.8945416212081909,0.17268872261047363,0.5088147521018982,0.20789888501167297,-0.6353012323379517,0.5937294960021973,0.538061797618866,0.0427355095744133,-0.1610851287841797,-0.07979516685009003,0.4991828501224518,-0.5848479866981506,0.03233920410275459,-0.2460675984621048,-0.23556390404701233,0.6446278691291809,0.6523446440696716,0.8341312408447266,0.5648995637893677,-0.22815625369548798,0.4418601095676422,-0.29582178592681885,-0.7399103045463562,0.9666698575019836,-0.21376220881938934,-0.13572213053703308,-0.10773376375436783,-0.4290525019168854,0.9861628413200378,0.8997672200202942,0.609244167804718,-0.4222204089164734,0.020646976307034492,0.08189305663108826,-0.5302324891090393,0.6693616509437561,-0.5087090730667114,0.3965819478034973,-0.6740115284919739,-0.910889744758606,-0.07165378332138062,0.423805832862854,0.7754473686218262,-0.38803422451019287,0.6661995053291321,-0.49595239758491516,-0.42285335063934326,0.15695469081401825,0.7553973197937012,0.5380791425704956,0.505801796913147,0.9391031265258789,-0.12353122979402542,0.42743581533432007,0.3895881175994873,0.5032086968421936,-0.8846530318260193,0.7955560684204102,-0.3109058439731598,0.8938828110694885,0.11197881400585175,-0.5772913694381714,0.8777852654457092,-0.7911672592163086,-0.3369344174861908,0.6709011793136597,-0.6799828410148621,-0.9876790046691895,-0.7802691459655762,-0.4342125356197357,-0.20255900919437408,-0.4805803596973419,-0.7913289666175842,0.18471045792102814,0.9238225817680359,-0.9855600595474243,0.8186759948730469,0.08628952503204346,-0.48810875415802,-0.4961569905281067,0.5323543548583984,0.4127545952796936,0.7673590779304504,-0.19192399084568024,-0.33056607842445374,-0.3008379340171814,-0.07137741893529892,0.9308662414550781,-0.6093811988830566,0.8414814472198486,-0.10508374124765396,0.12366187572479248,-0.4866175353527069,0.6169347763061523,0.9676479697227478,0.9936767816543579,-0.9723914861679077,-0.6623070240020752,-0.0849270448088646,0.5045989155769348,-0.1265973448753357,-0.704589307308197,0.2891344428062439,0.3125341832637787,-0.5101729035377502,-0.516148567199707,0.7021863460540771,0.07969777286052704,-0.04411765933036804,-0.5443428754806519,0.9858279228210449,-0.14093534648418427,-0.6112844944000244,0.3309480547904968,-0.502714216709137,-0.4803162217140198,-0.9450693130493164,-0.1932050734758377,0.6121964454650879,0.882872462272644,0.7229092717170715,0.2650686204433441,0.23136240243911743,0.6515604257583618,-0.854759156703949,0.234731987118721,-0.6418524980545044,-0.9796112775802612,-0.372126042842865,-0.3875439465045929,-0.28431594371795654,-0.7544918656349182,0.6442285180091858,0.22122563421726227,-0.6827197074890137,-0.2703651189804077,-0.9378178715705872,-0.662528395652771,0.27151867747306824,0.0381612703204155,-0.9605758190155029,0.34610581398010254,-0.6055173277854919,0.07069093734025955,0.3326724171638489,-0.025583697482943535,0.868130624294281,0.48154333233833313,0.3416585624217987,-0.9725141525268555,-0.11535261571407318,-0.924675703048706,0.6589433550834656,-0.46932223439216614,0.5767799019813538,-0.47706007957458496,0.39176225662231445,0.87559974193573,-0.014147785492241383,0.04814009740948677,-0.9280507564544678,-0.9355789422988892,-0.21057568490505219,-0.20229436457157135,-0.2014545500278473,0.9961065649986267,-0.5675142407417297,0.9489068984985352,0.043426305055618286,-0.7077827453613281,0.5582878589630127,0.704296350479126,0.5784276723861694,-0.09263397008180618,-0.4433545172214508,-0.6812626123428345,-0.8338039517402649,0.28364571928977966,-0.609729528427124,-0.6084488034248352,0.4716675281524658,0.1224866509437561,-0.8580074906349182,-0.6234180927276611,-0.27335846424102783,-0.5810711979866028,0.42241618037223816,0.8086687326431274,0.5442737340927124,-0.8217470049858093,-0.9931214451789856,0.1465548276901245,-0.9360606670379639,-0.28612908720970154,-0.9747577905654907,-0.8315430283546448,0.763990581035614,-0.31610000133514404,0.07500578463077545,-0.12581808865070343,0.5674941539764404,0.25884678959846497,-0.6914860010147095,0.9606061577796936,-0.20074278116226196,0.5086682438850403,0.29860833287239075,-0.2700500190258026,0.47519388794898987,0.41566237807273865,0.08347950130701065,-0.3673085868358612,0.7284194827079773,0.2924099564552307,-0.9842903017997742,0.34982094168663025,0.8617687225341797,-0.6693065762519836,-0.6016705632209778,-0.9182495474815369,0.882562518119812,-0.16945040225982666,-0.9312983155250549,0.972723126411438,0.32216790318489075,-0.7897077798843384,-0.2196253091096878,0.7500196695327759,0.21205809712409973,-0.535224437713623,-0.3863811194896698,0.14574876427650452,0.9075773358345032,-0.12394384294748306,-0.7918871641159058,-0.8544616103172302,0.21845924854278564,-0.20442353188991547,0.9587344527244568,0.41421058773994446,-0.09790823608636856,-0.34441161155700684,0.8226023316383362,-0.3176562190055847,0.5924004316329956,-0.8707327842712402,0.5855876207351685,-0.2780168354511261,-0.6736388802528381,-0.9864284992218018,0.4032447040081024,-0.6805304288864136,-0.6150037050247192,0.35357004404067993,-0.5362558364868164,-0.15010735392570496,0.7839171886444092,0.5041458606719971,-0.00945985410362482,0.6503140330314636,-0.9366102814674377,-0.9947906732559204,0.585908830165863,0.534831166267395,-0.5150752663612366,-0.0423266738653183,-0.9582912921905518,0.9176954627037048,-0.6723586916923523,-0.8563422560691833,0.2500104606151581,0.8314816951751709,0.9111181497573853,-0.9521820545196533,0.768610954284668,0.06786004453897476,-0.2862582802772522,-0.5577614903450012,0.5812057852745056,-0.0070110829547047615,-0.4040885269641876,-0.49680325388908386,0.30214324593544006,-0.8325790166854858,0.9160628914833069,0.9018303751945496,0.4525609314441681,0.27120697498321533,0.6806016564369202,-0.37866833806037903,0.1768043041229248,0.187932550907135,-0.17285770177841187,-0.40043845772743225,-0.9724999070167542,0.14302001893520355,0.7505396604537964,0.7365120649337769,-0.6307628154754639,0.43272730708122253,0.27587947249412537,-0.7827200889587402,-0.9661266207695007,-0.15970177948474884,0.957091748714447,-0.02857126109302044,0.6520721316337585,-0.8124085068702698,-0.8960387706756592,-0.931908369064331,0.39103764295578003,0.5755969882011414,-0.16744887828826904,-0.5980876088142395,0.4686492681503296,-0.8434944152832031,-0.25010916590690613,0.6858353614807129,-0.34974372386932373,0.32059624791145325,0.6715412735939026,-0.7550414204597473,-0.7640078663825989,-0.7401110529899597,0.1415942758321762,-0.7475814819335938,-0.5671576261520386,-0.737727701663971,-0.13418255746364594,0.468885600566864,0.2668547034263611,0.24620875716209412,0.788496196269989,0.23177018761634827,0.8300883769989014,0.4889311194419861,-0.15638861060142517,-0.9396694302558899,0.8230174779891968,-0.4217762053012848,-0.926453173160553,-0.6310651898384094,-0.08305429667234421,0.180932879447937,0.9119674563407898,0.47753503918647766,-0.612766444683075,0.13280650973320007,0.5432742834091187,-0.9826912879943848,0.17435318231582642,0.4735063314437866,0.9615091681480408,0.7393980026245117,-0.6640725135803223,0.5490878820419312,0.7249584794044495,0.6219656467437744,0.3818766176700592,-0.8423081040382385,0.15514765679836273,0.2967483699321747,0.531393826007843,0.033902693539857864,0.4167732894420624,0.07026278972625732,-0.6954046487808228,-0.3906209170818329,0.7667979001998901,-0.19908837974071503,0.018930573016405106,-0.5400516390800476,0.6593772768974304,-0.7745235562324524,0.3045675754547119,0.13350626826286316,-0.8088388442993164,-0.013190588913857937,0.7646742463111877,0.8802627921104431,0.502448320388794,0.42756813764572144,-0.12358039617538452,-0.26543131470680237,0.7852848768234253,0.20151294767856598,-0.6986883878707886,-0.5980024337768555,-0.11588357388973236,-0.8763799071311951,-0.43011948466300964,0.8434998989105225,-0.4556995630264282,0.625036358833313,-0.08941773325204849,-0.7562451362609863,-0.5184261798858643,0.05160248279571533,-0.05050395056605339,0.21995724737644196,0.6723625659942627,0.27145352959632874,-0.8491755723953247,0.46801504492759705,-0.022995075210928917,-0.21659532189369202,0.9048386812210083,-0.32797494530677795,0.6582834720611572,-0.7524685263633728,-0.8143348097801208,-0.3863624930381775,-0.04320685565471649,0.18819394707679749,-0.14863669872283936,0.6809810400009155,-0.9974600672721863,0.9171596765518188,-0.7139041423797607,0.6245366334915161,0.6421923041343689,-0.17049409449100494,-0.49860599637031555,-0.5919621586799622,0.6508141756057739,-0.4348728060722351,0.34217900037765503,-0.9739322066307068,0.6080762147903442,-0.12832099199295044,0.7736320495605469,0.7998930215835571,0.8500905632972717,-0.47634178400039673,0.3037623465061188,0.9510205984115601,-0.7427463531494141,-0.7837606072425842,0.21117980778217316,-0.5456447005271912,0.944255530834198,0.09690268337726593,-0.5155340433120728,0.5962749123573303,-0.2684530019760132,0.9943830370903015,0.38395094871520996,0.9080497026443481,-0.010737930424511433,0.9508167505264282,0.6759302616119385,-0.09217050671577454,-0.7405164837837219,0.7475956678390503,-0.40852752327919006,0.12446015328168869,0.2332831174135208,-0.5646860599517822,-0.12077365070581436,0.13680948317050934,0.30803272128105164,0.03337535634636879,0.8460391759872437,0.029191169887781143,-0.30126842856407166,-0.11496308445930481,-0.5784628987312317,0.21701867878437042,0.19709725677967072,-0.5490000247955322,0.3420531451702118,-0.79440838098526,-0.7291468977928162,-0.7208443880081177,-0.5933838486671448,-0.15298479795455933,0.2119920402765274,0.7191652059555054,0.8027428984642029,0.5649562478065491,-0.10798122733831406,0.7817675471305847,0.9362775683403015,0.33207422494888306,-0.6413124799728394,-0.20112644135951996,0.5329685807228088,0.6886090040206909,-0.8463701605796814,-0.8316376209259033,-0.9951168894767761,-0.1156131848692894,0.38219648599624634,0.16263170540332794,-0.17267954349517822,-0.0878162831068039,0.608066737651825,0.42885124683380127,0.1975240260362625,0.3532271087169647,-0.607963502407074,0.7464034557342529,0.536499559879303,-0.7815356850624084,0.3845679461956024,-0.922096312046051,-0.5505602359771729,0.4822569787502289,0.9962519407272339,-0.5266709923744202,-0.523324728012085,-0.3178667724132538,0.7410333752632141,0.5760121941566467,0.2557513117790222,-0.37876635789871216,0.9459637999534607,-0.27142348885536194,-0.980939507484436,0.04369613155722618,0.005941243376582861,-0.9925626516342163,-0.12849807739257812,0.16491129994392395,-0.8404790163040161,0.10429786890745163,-0.19447395205497742,-0.7942997217178345,0.49895331263542175,-0.01727854460477829,-0.6101254820823669,0.013490787707269192,0.7780749797821045,0.8975168466567993,-0.12538160383701324,0.04345184192061424,-0.6154838800430298,0.37829622626304626,-0.9490614533424377,0.1349467933177948,-0.4974188804626465,0.2225048989057541,0.35140347480773926,-0.25142332911491394,0.46201518177986145,-0.8652874231338501,0.8169288635253906,-0.6609671711921692,-0.9927811622619629,-0.28869935870170593,-0.16308335959911346,0.8200485706329346,0.5630360841751099,-0.916556715965271,0.9177271127700806,0.6686158776283264,-0.9471851587295532,-0.7992364168167114,-0.01717662252485752,-0.7070446014404297,-0.18274769186973572,-0.9185060858726501,-0.8512406349182129,-0.00887317955493927,0.0713983103632927,-0.7670232653617859,-0.6306846141815186,0.5083608031272888,-0.3939867615699768,-0.44396767020225525,-0.7219145894050598,-0.15640385448932648,0.9496764540672302,0.6689615845680237,-0.4428834319114685,-0.41216567158699036,-0.9653715491294861,0.7984512448310852,0.03515483811497688,-0.6304936408996582,-0.13307054340839386,-0.7693057656288147,0.5976314544677734,0.09544756263494492,-0.7464829087257385,-0.757904589176178,-0.901607871055603,0.6444750428199768,-0.345841646194458,0.753851592540741,0.5249769687652588,-0.9187139272689819,0.4042268395423889,0.5079547166824341,0.29681164026260376,-0.32754525542259216,-0.3183688223361969,-0.8247584700584412,0.8688049912452698,0.9331574440002441,0.5485464334487915,0.986373782157898,0.27730125188827515,-0.8479868173599243,-0.804000198841095,0.9651703238487244,-0.6467629075050354,0.9312889575958252,0.2441360205411911,-0.7981327772140503,0.6250933408737183,-0.0026383681688457727,0.7994122505187988,-0.7148818969726562,0.37679919600486755,-0.9380275011062622,-0.7010768055915833,0.8203843832015991,0.13251346349716187,-0.5939298868179321,0.8036549687385559,-0.5675375461578369,-0.589218258857727,-0.7164404988288879,-0.9468234181404114,0.27260804176330566,0.4564419686794281,0.24473093450069427,0.1593751460313797,-0.6989436149597168,-0.07596740871667862,0.3388183116912842,-0.7863138318061829,-0.500800371170044,-0.6415592432022095,0.29581066966056824,0.36293062567710876,-0.8498823046684265,0.26206135749816895,-0.03477094694972038,-0.7446207404136658,0.3150753378868103,0.15455637872219086,0.7165453433990479,0.8077325820922852,0.6170169115066528,0.27578023076057434,0.07134551554918289,-0.8761789202690125,0.08317672461271286,0.23124513030052185,0.5788775682449341,0.40638867020606995,-0.3961445987224579,-0.945175051689148,-0.8308009505271912,0.8607237935066223,-0.1390640139579773,-0.8675433397293091,0.581456184387207,0.80409836769104,-0.8745606541633606,0.4199208617210388,-0.5815765261650085,0.2945687770843506,0.9541363716125488,0.002900768304243684,-0.31123825907707214,0.11442543566226959,0.34804460406303406,-0.24222217500209808,0.8458035588264465,0.898457407951355,0.731991171836853,0.415174663066864,-0.8982895016670227,-0.36807867884635925,-0.022329822182655334,-0.33635473251342773,0.5529297590255737,0.207803875207901,0.7940444946289062,0.8215230107307434,-0.3339034616947174,-0.8963160514831543,0.5767430067062378,-0.4179443120956421,-0.09220363199710846,0.8459424376487732,-0.36400216817855835,0.28439250588417053,-0.22020085155963898,0.045608680695295334,-0.9260036945343018,0.6401675343513489,-0.2932731509208679,0.8280729055404663,0.06437776982784271,-0.9991005659103394,-0.4919246435165405,-0.04812756925821304,0.8703524470329285,-0.6657742857933044,0.49310073256492615,-0.444082111120224,-0.47639960050582886,0.5531542301177979,0.8848498463630676,-0.9190962314605713,-0.6146783828735352,-0.1992112398147583,-0.7001693844795227,0.2587035596370697,0.7549628615379333,-0.07514585554599762,0.446853905916214,0.7648245096206665,0.955409586429596,-0.5072484612464905,-0.5255304574966431,-0.8129376173019409,0.3775648772716522,0.5677953362464905,-0.7817164659500122,0.20756158232688904,-0.2744869887828827,0.3731023371219635,-0.371582955121994,0.13418260216712952,0.6737859845161438,0.10679224878549576,-0.7285815477371216,0.6864501237869263,0.623218297958374,-0.3913620114326477,-0.6080371141433716,0.07468412816524506,-0.9788000583648682,-0.2576802968978882,0.21479536592960358,-0.24662905931472778,-0.5166001319885254,0.5162332653999329,-0.1801324039697647,-0.983846127986908,-0.2064269781112671,0.895847737789154,-0.4853442907333374,-0.3386322855949402,-0.7761455178260803,0.09800954908132553,0.4137643277645111,-0.6057106852531433,0.09938868880271912,0.5764250755310059,-0.48073452711105347,0.2811312973499298,0.28691351413726807,0.7132995128631592,-0.16959314048290253,-0.13112643361091614,0.5575563311576843,0.10720492154359818,0.03337739035487175,0.7015612721443176,0.8862995505332947,0.5148862600326538,0.06937852501869202,-0.6421170234680176,-0.6864204406738281,-0.4573085904121399,-0.4606292247772217,-0.47489291429519653,0.7738592624664307,-0.772789478302002,-0.6226086020469666,0.651548445224762,0.6177520155906677,0.7133467197418213,0.325748085975647,-0.9844024777412415,0.7411766648292542,0.7338947057723999,-0.6517797112464905,-0.518281102180481,0.5128917098045349,-0.2855992317199707,0.11967114359140396,0.6186695098876953,-0.4932854473590851,-0.7052492499351501,-0.7253603935241699,0.512931764125824,0.5349856615066528,-0.343413382768631,0.04588509351015091,-0.9717044830322266,0.2618316113948822,0.9645593166351318,-0.45120862126350403,-0.2815427780151367,-0.5049757957458496,0.6671568155288696,0.0971929058432579,0.7911392450332642,0.13474956154823303,-0.23384854197502136,0.8751135468482971,-0.3529302477836609,-0.9037585854530334,0.4355210065841675,0.2140415906906128,0.47587257623672485,0.6058059334754944,-0.6850348114967346,-0.005235898308455944,0.29777514934539795,0.6364451050758362,-0.21809899806976318,0.7355757355690002,0.5724211931228638,-0.1742817759513855,-0.6305927634239197,0.11450919508934021,-0.9478263258934021,0.6872862577438354,-0.2457476109266281,-0.41168880462646484,0.11485112458467484,0.8888295292854309,-0.7325577139854431,0.7482751607894897,-0.9677131772041321,0.998388946056366,-0.8483099341392517,0.16040654480457306,-0.01261447835713625,-0.3359995484352112,-0.12417083978652954,0.8833300471305847,-0.8474525809288025,0.18043945729732513,0.24797841906547546,0.38280436396598816,0.7754553556442261,-0.36795294284820557,-0.6931908130645752,-0.14781366288661957,0.2725728154182434,0.15193890035152435,0.6380783319473267,0.6916337013244629,0.3117285370826721,0.9081215262413025,0.8798668384552002,-0.9744999408721924,-0.0077178082428872585,0.39210182428359985,0.3439614474773407,0.012573801912367344,0.359022855758667,-0.1449252963066101,-0.6597599387168884,-0.22506974637508392,0.07107281684875488,0.9949519038200378,-0.5737082958221436,0.3222237229347229,-0.7065915465354919,0.30000680685043335,-0.14464376866817474,0.4524221420288086,-0.34745073318481445,-0.6602502465248108,0.260987251996994,0.7472188472747803,0.26632657647132874,-0.2919750213623047,-0.45061758160591125,-0.8631585836410522,0.2516389787197113,-0.570279598236084,0.2670608460903168,-0.4399629831314087,-0.9902036786079407,0.4220393896102905,-0.8020531535148621,0.5392957925796509,0.5344076156616211,-0.0802072063088417,-0.3357595205307007,-0.6526307463645935,-0.9384215474128723,0.07062982767820358,-0.7159574627876282,-0.7622148990631104,-0.5662242770195007,0.4742322862148285,0.6977888345718384,0.7420686483383179,0.5206946730613708,0.07584670931100845,-0.17350634932518005,0.45912519097328186,-0.14116011559963226,-0.7588350772857666,-0.551145076751709,0.3100756108760834,0.7352609038352966,-0.024741774424910545,-0.9636871814727783,-0.0014228296931833029,0.10293972492218018,-0.6552127599716187,0.6163439154624939,-0.5356744527816772,0.5052683353424072,0.3347918391227722,0.7649893164634705,-0.577339768409729,-0.797469973564148,-0.23080210387706757,0.5127400755882263,-0.890853226184845,-0.9490411877632141,-0.02349216677248478,0.850444495677948,0.5554755330085754,-0.08084738999605179,0.31245461106300354,-0.6383900046348572,0.3868448734283447,-0.4790883958339691,-0.42354241013526917,-0.5238023400306702,0.2741205096244812,0.8685044646263123,-0.5055553913116455,0.7945685386657715,0.5442768335342407,-0.5178991556167603,-0.03812263160943985,0.2686547040939331,-0.5469653606414795,-0.10641585290431976,0.43603217601776123,0.49713850021362305,-0.4967229962348938,0.6815522313117981,-0.9689383506774902,-0.35997626185417175,-0.012595782056450844,0.05992845073342323,-0.31484174728393555,0.8245552182197571,0.8274457454681396,-0.8528965711593628,-0.7729242444038391,-0.8658745884895325,-0.21354816854000092,0.6390988826751709,0.48352912068367004,-0.6809529662132263,-0.530634880065918,0.5016555190086365,0.19328442215919495,-0.6554230451583862,0.5989450216293335,-0.3717581033706665,-0.589428722858429,0.26294225454330444,0.32810455560684204,-0.668379545211792,-0.3862259089946747,-0.6818384528160095,-0.2521640658378601,0.4028145372867584,0.9287762641906738,-0.13385939598083496,0.6075893640518188,-0.9421185851097107,0.9542252421379089,-0.7526174783706665,-0.2530911862850189,-0.005852700211107731,0.8345239162445068,0.45897355675697327,-0.5108000040054321,0.97810298204422,0.4605831205844879,-0.38426434993743896,0.4758913815021515,-0.35182487964630127,0.024407757446169853,-0.1547296941280365,0.8490398526191711,-0.2050817608833313,-0.03821827098727226,-0.3090522885322571,0.07009903341531754,0.9206217527389526,0.03856385126709938,0.040434081107378006,0.8073843717575073,-0.5085320472717285,-0.9747284054756165,-0.30210646986961365,-0.2992975115776062,-0.2171255648136139,-0.6784856915473938,-0.14187335968017578,0.27250468730926514,0.15406212210655212,0.93923419713974,-0.30104902386665344,-0.8821411728858948,0.13713154196739197,-0.6402791738510132,0.7874390482902527,0.768704891204834,-0.6263570189476013,0.596793532371521,0.833970308303833,0.8590577840805054,-0.1949358433485031,0.2982253134250641,0.2056012898683548,-0.5677842497825623,0.18107114732265472,-0.6821890473365784,-0.28533586859703064,-0.6181731224060059,0.34830471873283386,0.019035538658499718,-0.613254964351654,0.055243343114852905,-0.8522992134094238,0.8462686538696289,-0.04629379138350487,-0.10039319097995758,-0.45527854561805725,0.6348414421081543,-0.4043332636356354,0.29382145404815674,-0.38687941431999207,-0.7628481984138489,0.6612330675125122,-0.2309502810239792,0.7119057178497314,-0.15075132250785828,0.6636092662811279,-0.8514030575752258,-0.738807737827301,-0.6507847905158997,0.7675595283508301,0.6866306662559509,-0.9867897629737854,0.9926661252975464,0.09200041741132736,0.48939216136932373,-0.8740833401679993,-0.14915034174919128,-0.3524501919746399,-0.8030369877815247,0.5922662019729614,0.9623778462409973,-0.2593388855457306,0.15133288502693176,-0.6774006485939026,0.15386246144771576,0.7735044360160828,-0.7020596861839294,-0.7221774458885193,-0.42447754740715027,0.19470326602458954,-0.3753865957260132,0.503427267074585,-0.8956356048583984,-0.48750633001327515,-0.6008783578872681,0.3703586757183075,-0.2612464427947998,-0.0596923902630806,0.5210269093513489,-0.8708007335662842,-0.4906521439552307,0.30207255482673645,-0.13197599351406097,-0.937382161617279,-0.11755191534757614,-0.7551218867301941,-0.4195323586463928,-0.006248988211154938,0.31826379895210266,-0.08789871633052826,-0.9990733861923218,-0.15760134160518646,-0.6072199940681458,0.4220527410507202,0.5767764449119568,-0.06355799734592438,0.028771933168172836,0.08354540169239044,0.31458646059036255,-0.5854219198226929,0.6667550206184387,0.15535418689250946,0.33945339918136597,-0.9926680326461792,0.061283182352781296,-0.35733217000961304,0.405468612909317,-0.24074755609035492,-0.8798953890800476,-0.20518289506435394,0.9962339401245117,0.2151651829481125,-0.9431456327438354,0.10665376484394073,0.9013762474060059,0.48869362473487854,-0.7285830974578857,-0.7963725328445435,0.7883343696594238,0.919407308101654,-0.9983291625976562,-0.7617980241775513,0.16076241433620453,0.655924916267395,-0.5802534222602844,0.12107214331626892,0.5139789581298828,-0.406312495470047,-0.9588074088096619,0.2746456265449524,-0.9078909754753113,-0.11282999068498611,-0.5895000100135803,0.02015419490635395,-0.1572563648223877,0.7109734416007996,0.9108520150184631,-0.5652366876602173,-0.42722269892692566,0.46318191289901733,-0.35908839106559753,-0.5725057721138,-0.6375037431716919,-0.9158249497413635,0.0834941565990448,0.8738236427307129,0.9989845752716064,-0.17673534154891968,-0.8256247639656067,-0.07921452075242996,0.8335674405097961,0.4208677113056183,0.30572569370269775,0.3419080674648285,0.4589899778366089,0.13910436630249023,0.25981244444847107,-0.05004429444670677,-0.0767471045255661,-0.8801576495170593,-0.4242820739746094,-0.7842001914978027,0.1897491216659546,-0.9848079085350037,0.3482733964920044,-0.8223384618759155,-0.10075362771749496,0.1881996989250183,0.9295873641967773,0.7660171985626221,0.9304357767105103,-0.5850326418876648,0.004490602295845747,-0.335496723651886,-0.4569844603538513,0.1558772474527359,0.39020535349845886,0.06711632013320923,0.4150426983833313,-0.9178816080093384,0.568892240524292,0.4463517665863037,-0.8209688067436218,-0.4024161100387573,0.9045422077178955,-0.6416541934013367,0.49270889163017273,0.6131637096405029,-0.9370778203010559,-0.7513631582260132,0.8427630066871643,0.8829625248908997,0.3294736444950104,-0.03437553346157074,0.9359869956970215,0.19994664192199707,-0.8680819272994995,-0.42114564776420593,0.40996208786964417,0.285327672958374,-0.207192525267601,-0.4462447166442871,0.1273423433303833,0.41557297110557556,0.6498841643333435,0.24071937799453735,0.050322867929935455,-0.7945141792297363,0.5337075591087341,-0.22694866359233856,0.42469096183776855,0.27047812938690186,0.4281030595302582,0.15745601058006287,-0.09163268655538559,0.7319687604904175,-0.9765355587005615,-0.3086504638195038,0.31362786889076233,-0.47177910804748535,-0.2992669343948364,0.24919141829013824,0.28465041518211365,0.6225764751434326,-0.15878191590309143,0.0591377355158329,0.8152543902397156,0.9206997752189636,0.2879607677459717,-0.007545327302068472,-0.09105006605386734,0.23059488832950592,-0.9935207962989807,-0.24959133565425873,0.2010928988456726,-0.9955593943595886,0.47248780727386475,-0.651197075843811,-0.6416868567466736,0.257112979888916,-0.5269778966903687,-0.17753346264362335,-0.40818360447883606,-0.24503785371780396,-0.8997256755828857,-0.17006489634513855,0.19817428290843964,-0.9346674084663391,0.9371843338012695,-0.7186367511749268,-0.7986501455307007,0.9436166882514954,-0.544788122177124,-0.34027740359306335,0.750682532787323,-0.19124822318553925,0.2463332861661911,0.9162967205047607,-0.525103747844696,0.9144147634506226,0.17526236176490784,-0.46873220801353455,0.5336316227912903,-0.5128169655799866,-0.40270376205444336,0.6360530257225037,-0.13628464937210083,0.5940938591957092,-0.865367591381073,-0.6333742141723633,-0.11630041897296906,-0.246116042137146,0.17592063546180725,-0.211912602186203,-0.4155895709991455,0.4908633232116699,0.5407937169075012,0.47910159826278687,-0.264394611120224,0.9880496263504028,-0.9709139466285706,0.40964818000793457,0.9381589889526367,0.1957729160785675,-0.6963898539543152,-0.5638540983200073,-0.017930466681718826,-0.817870557308197,0.09882937371730804,0.018732542172074318,-0.19647450745105743,-0.8098284602165222,-0.7828295826911926,0.5910040736198425,0.29550662636756897,0.3577197790145874,-0.5072164535522461,-0.32428425550460815,0.8886241316795349,0.0376930832862854,-0.41581252217292786,0.2810080349445343,0.28347739577293396,0.05658097565174103,0.6880218982696533,-0.7331100106239319,-0.8091647624969482,0.6866145730018616,0.67154860496521,0.4935981333255768,0.2256591022014618,-0.8634538650512695,-0.17679893970489502,-0.6851754188537598,0.4647044539451599,-0.5850025415420532,0.9572375416755676,-0.26325082778930664,-0.32153040170669556,0.9776719808578491,0.9243503212928772,-0.4206118881702423,-0.49575403332710266,0.016096513718366623,-0.35455232858657837,0.6964678764343262,0.6355066299438477,-0.6538026928901672,0.8956681489944458,-0.2867707312107086,0.5548495650291443,0.1784140020608902,-0.7247429490089417,0.020012952387332916,0.7590481638908386,0.7825115323066711,0.09212260693311691,0.8946232199668884,0.6216892004013062,0.23205627501010895,-0.3198028802871704,0.7310478687286377,-0.5237113833427429,0.7929460406303406,-0.7529445290565491,-0.2833960950374603,0.12872664630413055,0.03367419168353081,-0.8343678116798401,-0.6336807012557983,-0.4921639859676361,-0.025599060580134392,-0.9738183617591858,0.5702391862869263,0.8446947336196899,0.5136234760284424,-0.8072183728218079,-0.6859292984008789,0.49769747257232666,-0.8036518692970276,-0.46064385771751404,-0.7045016884803772,-0.8115527629852295,-0.7256990671157837,0.4533138871192932,0.6281909346580505,-0.28636470437049866,0.21132364869117737,-0.46627911925315857,-0.6796520352363586,-0.8108242750167847,-0.6596516966819763,-0.2864958941936493,0.13395336270332336,-0.14260132610797882,-0.2992415726184845,-0.4642285406589508,0.19233275949954987,-0.3826156556606293,0.15305045247077942,-0.10981940478086472,-0.960764467716217,0.8464186191558838,0.07457462698221207,0.032239142805337906,-0.1934061050415039,-0.16444532573223114,0.7986415028572083,0.8483099341392517,0.8199306726455688,-0.9826834797859192,-0.7936627864837646,0.5096523761749268,0.7507779598236084,-0.36522114276885986,-0.1618596762418747,-0.25943246483802795,-0.21170835196971893,-0.9295977354049683,0.9121484756469727,-0.40441861748695374,-0.5581983923912048,-0.5333978533744812,-0.5728720426559448,0.9499793648719788,0.6623601317405701,0.35842275619506836,-0.9843137860298157,0.2733529508113861,-0.48306459188461304,0.09270185232162476,0.7470861077308655,0.6383842825889587,-0.18789447844028473,-0.7569112777709961,0.7855041027069092,0.22263528406620026,0.05290956795215607,0.1681457757949829,-0.0417323037981987,-0.7116680145263672,-0.6897421479225159,-0.711553156375885,0.6842265725135803,0.634721577167511,0.7883099913597107,0.7112215757369995,0.22655513882637024,0.30374887585639954,-0.8664305210113525,-0.05820772424340248,0.2013295292854309,0.8356196880340576,-0.7274609208106995,0.014794186688959599,-0.6826881170272827,0.7966839671134949,0.4492948353290558,-0.7576180100440979,-0.539100170135498,-0.22792157530784607,-0.5420899987220764,0.4574088752269745,-0.3101738691329956,-0.2523843050003052,-0.513023853302002,-0.798432469367981,0.10611468553543091,-0.8905221223831177,-0.09044200927019119,-0.6751580238342285,0.49962398409843445,0.960542619228363,0.6708451509475708,-0.8637306094169617,0.5389029383659363,0.6946966052055359,0.027599934488534927,0.2605695426464081,0.032957401126623154,0.22192725539207458,0.14741109311580658,0.0671965479850769,-0.8582307696342468,-0.7326477766036987,-0.2334187775850296,0.528380811214447,-0.47580257058143616,0.5720386505126953,0.5681909322738647,0.9984177350997925,0.021574659273028374,0.3086211681365967,-0.0399758480489254,-0.7486552596092224,0.22964927554130554,-0.28682073950767517,-0.2197277843952179,-0.9908674955368042,0.9771596193313599,-0.7915113568305969,-0.7605396509170532,0.10838240385055542,0.37787961959838867,0.709838330745697,-0.8621447682380676,-0.6618342995643616,-0.6221801042556763,-0.6551396250724792,0.9478154182434082,0.6313974857330322,-0.5263640284538269,0.19889627397060394,-0.5721913576126099,-0.6776453256607056,0.47973889112472534,-0.2860962152481079,-0.09880831092596054,-0.22526659071445465,0.01797807402908802,-0.5104687809944153,0.6550552248954773,-0.6803760528564453,-0.16834565997123718,-0.751105785369873,-0.026626529172062874,0.17262279987335205,0.3081567883491516,-0.9718580842018127,-0.6629227995872498,0.7575986981391907,0.3018646538257599,-0.4726710915565491,0.34964263439178467,0.6665521264076233,0.4297223389148712,-0.3860720098018646,0.6693435311317444,0.8129041194915771,-0.20129196345806122,-0.6974830031394958,0.2349826991558075,0.8025408387184143,0.1623503565788269,-0.7387275099754333,0.13422155380249023,-0.19816145300865173,-0.3729683756828308,-0.6812405586242676,-0.6703281402587891,0.5990247130393982,0.057189278304576874,-0.7847028970718384,0.35681089758872986,-0.6309808492660522,-0.1814698874950409,-0.4389694333076477,-0.9798348546028137,-0.2773500680923462,-0.24752788245677948,-0.11053337156772614,0.13190487027168274,-0.8475306034088135,0.07336826622486115,0.9656878113746643,-0.6173153519630432,0.4378868043422699,0.12208481132984161,0.9836622476577759,0.577693521976471,0.9710578322410583,0.31383076310157776,-0.7848732471466064,0.9836831092834473,-0.2729010581970215,-0.7546176910400391,-0.7036036252975464,0.007951253093779087,-0.6303613781929016,-0.965138852596283,0.31817135214805603,0.48095962405204773,0.9844083786010742,-0.5464696884155273,0.9024986028671265,0.41512003540992737,-0.7695935368537903,0.6352040767669678,-0.15229643881320953,-0.5013948678970337,0.760704517364502,0.5995597839355469,-0.8046904802322388,-0.06967135518789291,-0.9123210310935974,-0.2787761390209198,0.6780312061309814,0.07798890024423599,0.10340676456689835,-0.5815818309783936,-0.924125611782074,-0.3245029151439667,0.8273173570632935,-0.33234408497810364,0.39903563261032104,0.753523051738739,0.824964165687561,0.14273011684417725,0.12940043210983276,-0.5682713985443115,-0.44792670011520386,0.8929474949836731,-0.0629066675901413,0.5056555867195129,-0.5017778873443604,0.38236767053604126,-0.13284346461296082,-0.7582095265388489,-0.5596539378166199,0.8670852184295654,0.5437700152397156,0.09516002237796783,0.7629214525222778,-0.2353830337524414,-0.7903221845626831,-0.7229546308517456,-0.0008851164602674544,-0.9145051836967468,-0.4431694447994232,0.0846126601099968,0.33083030581474304,-0.713461697101593,-0.7911911606788635,-0.22637005150318146,-0.8329291939735413,0.913830578327179,0.42051559686660767,-0.9594439268112183,-0.7657828330993652,-0.9537715911865234,0.6080198884010315,-0.07541874051094055,0.6738171577453613,0.007291943766176701,0.47868531942367554,0.20735393464565277,-0.5091419816017151,-0.2405717372894287,0.4008144438266754,-0.1842707097530365,0.059904828667640686,0.1598515510559082,-0.3356006145477295,0.3432319462299347,0.17677411437034607,0.8328028917312622,0.7225241661071777,0.6216942667961121,-0.4482228755950928,0.6903650760650635,-0.8940933346748352,0.10764940083026886,-0.23050661385059357,-0.6668961048126221,-0.7125366926193237,0.6691139936447144,0.8014891743659973,0.07882300764322281,0.4051196575164795,0.9077728390693665,0.46677905321121216,0.17481110990047455,-0.8634471893310547,0.27311986684799194,0.5210037231445312,-0.28979113698005676,0.6781005859375,0.7387431859970093,0.9343956112861633,-0.3490433692932129,0.9551050066947937,0.4691082537174225,0.22202904522418976,0.9384530782699585,0.4700794816017151,-0.8290274739265442,0.3991919159889221,0.08264827728271484,-0.15147727727890015,0.989583432674408,-0.20676031708717346,0.19227081537246704,0.41454336047172546,0.863872230052948,-0.36347606778144836,-0.25136950612068176,0.9272487163543701,-0.18160371482372284,-0.3445480167865753,0.11020863056182861,0.8279833793640137,0.5865659713745117,0.8284934163093567,-0.8759915232658386,-0.6622565984725952,-0.8798933029174805,-0.8281434178352356,0.359917014837265,0.8724257946014404,-0.9971531629562378,0.14326579868793488,-0.5860043168067932,0.055251941084861755,-0.10588512569665909,-0.9842129349708557,-0.279753178358078,0.3925361633300781,0.6990611553192139,-0.6553831100463867,-0.5519078373908997,0.9394385814666748,-0.003958402667194605,0.0964844599366188,-0.9277223348617554,-0.9074536561965942,-0.9287068843841553,0.028310375288128853,0.24996644258499146,-0.5463166236877441,-0.1084485650062561,-0.40292131900787354,-0.7022417187690735,-0.48894834518432617,0.4539726972579956,0.7083377838134766,-0.647984504699707,-0.7564296126365662,-0.47907590866088867,0.27293360233306885,-0.9983068108558655,0.048657603561878204,0.5805879831314087,0.7683067917823792,0.7054585218429565,-0.16493158042430878,-0.5896714329719543,0.6365073323249817,-0.4974971413612366,0.06330958008766174,-0.6562088131904602,0.8332129716873169,0.7302261590957642,-0.6992627382278442,0.5831962823867798,0.31894707679748535,-0.4223499298095703,-0.7006657719612122,0.7946000099182129,-0.31296268105506897,-0.8967098593711853,0.5488737225532532,-0.425287663936615,-0.9181452393531799,-0.7593913674354553,0.6007067561149597,0.8117710947990417,0.9921525716781616,-0.07705070823431015,0.8940669894218445,0.44386497139930725,0.09674974530935287,0.5459995269775391,-0.5675942897796631,-0.7243200540542603,0.5795616507530212,-0.6538498997688293,-0.7624931931495667,0.8760133385658264,-0.3587624132633209,-0.09950798004865646,0.699791669845581,0.16877056658267975,-0.1933334916830063,0.32438910007476807,-0.22022484242916107,-0.40761104226112366,-0.40179723501205444,-0.3076052963733673,-0.6867552995681763,-0.3944709897041321,0.254780113697052,0.25051531195640564,0.5449148416519165,0.03048815205693245,-0.42631790041923523,-0.658897876739502,-0.942918598651886,-0.6301612854003906,0.4262450337409973,-0.2830086946487427,0.15991702675819397,-0.2531117796897888,-0.9036446213722229,-0.12720724940299988,0.8720091581344604,-0.6087149381637573,0.32597559690475464,-0.913099467754364,0.6261668801307678,0.9780212640762329,-0.6970881819725037,-0.7277302145957947,0.219991996884346,-0.6320696473121643,-0.24196350574493408,0.6962089538574219,-0.13368572294712067,0.8508263230323792,-0.9016686677932739,-0.9678744673728943,-0.13513824343681335,-0.10493865609169006,0.9879636168479919,-0.7556930780410767,0.9952613711357117,-0.15901316702365875,-0.780705451965332,-0.6739423274993896,0.15257832407951355,-0.4850497245788574,0.5396029353141785,-0.7012991905212402,-0.48396146297454834,-0.2179635912179947,-0.19582714140415192,0.4003256559371948,0.08784039318561554,-0.9810352921485901,-0.5949230790138245,-0.29045483469963074,-0.9977414608001709,-0.6536667943000793,0.5389687418937683,0.7398406267166138,0.2649911940097809,-0.6911085844039917,0.14151570200920105,0.0013099568895995617,-0.08263489603996277,0.9931315183639526,-0.9071261882781982,-0.8695475459098816,-0.9392913579940796,0.466346800327301,-0.10590692609548569,0.5295301079750061,-0.5797107815742493,-0.6458432674407959,0.5171502828598022,-0.750575065612793,0.9193841814994812,0.5775947570800781,0.2939036190509796,-0.44494113326072693,0.170143261551857,-0.523906409740448,0.3714103400707245,-0.4079061448574066,0.24311046302318573,-0.10823412984609604,-0.46791744232177734,0.0014999117702245712,-0.9132183790206909,0.9800979495048523,0.8485099077224731,-0.09448517113924026,0.9708366990089417,-0.651627242565155,0.5965388417243958,0.34668126702308655,-0.639586329460144,0.6028028130531311,-0.7999100089073181,0.13636146485805511,-0.9975728392601013,-0.7998190522193909,-0.7768133282661438,0.5393610000610352,-0.5397372245788574,-0.6498887538909912,-0.9040756821632385,0.6064071655273438,0.26758402585983276,-0.7906272411346436,-0.07138881832361221,-0.6079100370407104,0.45852741599082947,-0.2851673364639282,0.8427366614341736,-0.8470399975776672,-0.48510369658470154,-0.8142446279525757,0.13604635000228882,0.6882287859916687,0.8045287132263184,-0.7704262137413025,-0.09372743964195251,0.18129435181617737,-0.855802595615387,-0.6505609154701233,-0.45856985449790955,-0.46060290932655334,-0.6352326273918152,0.8641494512557983,-0.38466113805770874,-0.953037440776825,-0.26003849506378174,0.2027297168970108,0.47662660479545593,0.706231951713562,0.9527320265769958,0.3738093674182892,0.1469002366065979,-0.9906813502311707,0.2890479266643524,-0.47403237223625183,-0.868598997592926,-0.4834044873714447,-0.3910600543022156,-0.32585516571998596,0.7052803039550781,-0.7884470224380493,-0.15853162109851837,0.7526831030845642,-0.3638841211795807,-0.9333261847496033,-0.853265643119812,0.23411518335342407,-0.8844117522239685,-0.22564993798732758,-0.11183909326791763,-0.9662315845489502,-0.7001732587814331,0.5756256580352783,-0.3676605522632599,-0.555915355682373,-0.47554391622543335,0.5510937571525574,0.8882313370704651,0.012916860170662403,0.4576955735683441,-0.8768662810325623,-0.36822542548179626,-0.7212103009223938,-0.09291683882474899,-0.8157597184181213,-0.49702927470207214,0.024186749011278152,-0.5759859085083008,-0.5283545255661011,-0.07913113385438919,-0.758808434009552,0.665703296661377,-0.4879356622695923,-0.8075236082077026,-0.2637357711791992,0.6330646872520447,-0.2940252125263214,0.8984742760658264,0.8871381878852844,0.8020262122154236,0.7138143181800842,0.0926378145813942,0.5313951373100281,0.4514285922050476,-0.41311928629875183,-0.2947397828102112,0.9363480806350708,0.20836032927036285,-0.1243886947631836,-0.29505231976509094,0.9295178651809692,-0.018975641578435898,-0.0002855499624274671,-0.15409304201602936,0.26137641072273254,0.49374300241470337,-0.4493100345134735,0.15398074686527252,-0.29220423102378845,0.6362570524215698,-0.6648445725440979,-0.9698558449745178,0.24086864292621613,-0.6318909525871277,0.46018803119659424,-0.9348059892654419,0.8388935327529907,0.1835327446460724,0.5547904968261719,0.02499917522072792,0.8566265106201172,0.2096163034439087,0.12777729332447052,-0.8684184551239014,0.518365204334259,0.9312347173690796,0.5816829800605774,0.6704915761947632,-0.5073606967926025,-0.0022235673386603594,0.6604093909263611,0.6434300541877747,-0.5779390335083008,-0.45426949858665466,0.17857079207897186,-0.2064971923828125,0.5313136577606201,0.3253909647464752,0.9547581672668457,-0.7547990083694458,-0.9651998281478882,0.695831298828125,0.028842266649007797,-0.39685797691345215,0.24702169001102448,-0.4008134603500366,-0.2955060601234436,0.07597460597753525,0.5552967190742493,0.7508077621459961,0.6953883767127991,-0.6314990520477295,-0.4783257842063904,-0.37176549434661865,-0.9727986454963684,-0.3401123881340027,0.030746981501579285,-0.9294041395187378,0.48386651277542114,0.4494483172893524,0.591781735420227,0.09951365739107132,0.3788498640060425,-0.0041700429283082485,0.46815747022628784,-0.29672569036483765,-0.9609454274177551,-0.6202477216720581,-0.36776483058929443,0.6828442811965942,0.4861050844192505,-0.3530997931957245,0.4515710473060608,-0.10695251077413559,0.40847063064575195,0.5006237030029297,-0.5411422252655029,-0.735389769077301,-0.8975783586502075,0.5327375531196594,0.5785694122314453,-0.2923033535480499,0.9166367650032043,0.0848197266459465,0.9920214414596558,0.2455451935529709,-0.6490469574928284,0.26311784982681274,0.7789711356163025,-0.9204726815223694,-0.7588040828704834,-0.6816319823265076,0.3035207986831665,0.3495621085166931,0.2997751235961914,-0.5902841091156006,-0.23772655427455902,-0.4469067454338074,0.11292482167482376,0.19819915294647217,0.9293070435523987,0.8220129013061523,-0.24474658071994781,0.4112112820148468,-0.00826513022184372,0.4056154787540436,-0.26126235723495483,0.37872856855392456,0.13279220461845398,0.0016717324033379555,0.8020151257514954,-0.4482598304748535,0.8623447418212891,-0.35563912987709045,-0.6343841552734375,-0.22574901580810547,0.3697623312473297,-0.28277528285980225,-0.020286448299884796,-0.9913714528083801,-0.6770736575126648,0.8651368021965027,-0.9963926076889038,-0.3773973882198334,0.441144734621048,0.2383957803249359,-0.29139336943626404,-0.2893957197666168,0.8858916759490967,0.46548572182655334,-0.7633445262908936,-0.2909298837184906,0.0730690285563469,-0.975756049156189,-0.672913134098053,-0.6529402136802673,0.8177627921104431,0.5117707848548889,-0.10184718668460846,-0.3947334289550781,0.8180669546127319,0.4404429793357849,-0.9418875575065613,0.4815623462200165,0.5428295135498047,0.8462264537811279,-0.7233858704566956,-0.5463700294494629,-0.5978136658668518,-0.7554275989532471,0.37697452306747437,-0.9286898374557495,0.16779372096061707,-0.3928343653678894,0.14151358604431152,0.3024791479110718,-0.5531138181686401,-0.4442567229270935,0.46834662556648254,0.8272913098335266,0.4678511917591095,0.23264551162719727,-0.8904002904891968,0.19414615631103516,-0.8949269652366638,-0.30166932940483093,-0.0338444821536541,0.3635270893573761,-0.12171421945095062,-0.2916213572025299,-0.7704249620437622,-0.6049669981002808,0.7297077178955078,0.7013962864875793,0.9009689688682556,0.48197758197784424,-0.6815915703773499,0.772996187210083,0.901563823223114,-0.8206532001495361,-0.6140782833099365,0.3935745656490326,0.15797097980976105,-0.042573925107717514,-0.11214201897382736,0.9012341499328613,0.08992674946784973,-0.82322096824646,0.8542830944061279,-0.2969624996185303,0.503427267074585,0.2662438452243805,-0.471543550491333,-0.15092338621616364,0.46402373909950256,0.2062429040670395,0.8756741285324097,0.4807256758213043,0.838620126247406,0.69352126121521,-0.04258755221962929,-0.26885679364204407,0.6749531030654907,0.1255452185869217,0.9334166646003723,0.5508841276168823,-0.15977315604686737,0.042841121554374695,-0.1293548345565796,-0.3507573902606964,-0.5807741284370422,-0.06805264949798584,0.732374906539917,-0.69135582447052,-0.5846464037895203,0.16418121755123138,0.19114279747009277,0.19729851186275482,0.1566689908504486,-0.801413357257843,0.1224590465426445,-0.5036119818687439,0.3409525156021118,-0.2355656623840332,-0.7368786334991455,0.2785489559173584,-0.7004517912864685,0.8354738354682922,-0.033816270530223846,-0.3132755160331726,0.17571809887886047,-0.21216771006584167,-0.1428273320198059,0.0648283064365387,0.18499775230884552,-0.574293315410614,0.5541440844535828,0.45368650555610657,-0.023526277393102646,-0.820990264415741,-0.6021396517753601,-0.24678826332092285,0.6384673118591309,0.1373320072889328,0.9643900394439697,0.13729064166545868,0.04226647689938545,-0.5671509504318237,-0.3308294713497162,-0.7445616126060486,-0.7168108820915222,0.48307377099990845,0.6319571137428284,-0.781126856803894,-0.8038240671157837,-0.13277289271354675,-0.3402406573295593,0.2950095236301422,-0.4417712688446045,0.8518729209899902,-0.2696306109428406,-0.9318446516990662,0.594603955745697,-0.5763009786605835,0.272940456867218,-0.25003740191459656,-0.41973572969436646,-0.6453579068183899,-0.4592052400112152,-0.7812623381614685,-0.8957798480987549,-0.5508465766906738,0.6885784864425659,0.7753580212593079,0.8881787061691284,-0.47101742029190063,0.3973652720451355,-0.2537277936935425,0.7060303688049316,0.5945081114768982,-0.1736779361963272,-0.10994399338960648,0.04223518818616867,-0.27877113223075867,-0.14558663964271545,-0.9232397079467773,-0.8341862559318542,0.8038972616195679,0.17935945093631744,0.5658009052276611,-0.5453735589981079,-0.9189358949661255,0.8151254057884216,0.7498894929885864,-0.45786812901496887,0.08751266449689865,0.30387744307518005,-0.5357688069343567,0.8947874903678894,-0.7178198099136353,-0.8971742987632751,-0.3439861536026001,0.41801917552948,0.01641463115811348,0.3952150046825409,-0.3242081105709076,-0.19207149744033813,-0.8867111802101135,0.9547942280769348,0.8135316371917725,0.8855231404304504,-0.016085634008049965,0.6617029905319214,-0.38798144459724426,-0.8599791526794434,0.8551241159439087,0.3798394501209259,-0.8766022324562073,0.6328619718551636,-0.5177937746047974,-0.9943037033081055,-0.9645190834999084,0.493712842464447,0.2594538629055023,0.28123903274536133,-0.8164990544319153,-0.47307369112968445,-0.4264112114906311,0.8188397884368896,0.6652144193649292,-0.6407753825187683,-0.7236596941947937,-0.0801357626914978,0.8103517889976501,0.8222888112068176,-0.09947124123573303,0.5441495776176453,-0.18499855697155,0.03141225501894951,-0.8327766060829163,-0.7033404111862183,0.06717560440301895,0.6021122336387634,0.5238357782363892,-0.5924913287162781,-0.917065441608429,0.538131833076477,-0.869284451007843,0.16556912660598755,-0.6036040782928467,0.9170031547546387,-0.1718447506427765,-0.7000932097434998,-0.6621360778808594,-0.44011446833610535,0.2985173761844635,0.6151269674301147,0.0651879832148552,0.8734167814254761,0.36461320519447327,0.41895169019699097,0.5738630890846252,0.8378276228904724,0.6064407229423523,0.9467630386352539,-0.7666475176811218,0.762103259563446,-0.8377856016159058,0.5703758597373962,-0.05769707262516022,-0.70328688621521,0.2945525348186493,0.6570602655410767,0.371764600276947,-0.16562554240226746,0.14660745859146118,0.7742241024971008,-0.7354602813720703,-0.2025754153728485,0.5533996224403381,-0.2621343433856964,-0.8681762218475342,0.49083149433135986,0.9046763181686401,-0.29379040002822876,-0.9819879531860352,0.42571181058883667,0.6263931393623352,0.8712112903594971,-0.25367963314056396,-0.8129544258117676,0.505239725112915,0.60284823179245,0.1390264481306076,-0.2107015699148178,0.4634864628314972,0.02310892939567566,-0.09344445914030075,0.10226075351238251,0.9898557662963867,0.8313108086585999,0.30757322907447815,0.8552460670471191,-0.19929230213165283,0.8195434212684631,-0.3251674175262451,0.49741342663764954,0.6651411652565002,0.12524570524692535,0.5170920491218567,0.6614468097686768,0.9888482093811035,0.467705637216568,-0.32446226477622986,0.23457947373390198,-0.9479774236679077,0.18426235020160675,-0.8914040923118591,-0.18052314221858978,-0.2806987166404724,-0.006445455364882946,0.2662356495857239,0.9560211896896362,-0.7197461128234863,0.13226699829101562,0.39288756251335144,0.3816591203212738,0.5891863703727722,-0.46252015233039856,0.13702169060707092,-0.576859712600708,-0.42587968707084656,-0.18631137907505035,-0.914017915725708,0.839931070804596,0.747655987739563,0.37908339500427246,0.8301613926887512,-0.42697346210479736,0.7333360910415649,0.5167329907417297,-0.5446739792823792,0.05196818336844444,-0.9474006295204163,0.8700183629989624,0.27849963307380676,-0.40957149863243103,0.2284257709980011,-0.6670829057693481,-0.3793959319591522,-0.4090258479118347,-0.4836435317993164,-0.9995225071907043,0.13269157707691193,-0.9109976887702942,-0.7862067818641663,0.09527967870235443,-0.05091997608542442,-0.04928912594914436,-0.7733767628669739,-0.5053415298461914,0.803712010383606,-0.856130063533783,-0.9405033588409424,0.9685485363006592,0.4216659367084503,-0.18004094064235687,-0.485664039850235,0.9491475224494934,-0.3689483404159546,-0.4289725124835968,0.8578108549118042,-0.2755889296531677,-0.5640551447868347,0.685728132724762,0.47330477833747864,0.8139904737472534,0.6618436574935913,-0.8677494525909424,-0.6831226944923401,0.5718267560005188,0.44757676124572754,0.009606437757611275,-0.04110485687851906,0.8444110751152039,-0.8681336641311646,-0.3238251209259033,0.5529019832611084,-0.27145129442214966,-0.8377707004547119,-0.1920383870601654,-0.6286858916282654,0.47523951530456543]]  # ç¤ºä¾‹å‘é‡

    print("\n--- ðŸ” Hybrid Search (åŽ»é‡åˆå¹¶) ---")
    results = await retriever.hybrid_search("documents", query_texts, query_vectors)
    for r in results:
        print(f"ChunkID: {r['id']} | Score: {r['merged_score']:.4f} | Source: {r['source']} | Text: {r['text'][:60]}...")

    await retriever.close()


if __name__ == "__main__":
    asyncio.run(main())
